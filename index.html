<!DOCTYPE html>
<html>
<head>
	<title>Albers Pong - Jacob Elias</title>

	<script type="text/javascript" src="../build/Pong.js"></script>
	<link rel="stylesheet" type="text/css" href="styles.css">
    <link rel="icon" type="image/png" sizes="32x32" href="assets/favicon.png">
    
	<script type="text/javascript">
		window.onload = function () {
			var pong = new Pong(document.getElementById('pong'));
//            var a = pong.players.a;
        

			function resize () {
				var gameHeight = window.innerHeight - 40 + 'px';
//				document.getElementById('pong').style.height = gameHeight;

				pong.resize();
			}

			resize();
			window.onresize = resize;

			pong.players.a.addControls({
				'up': 'up',
				'down': 'down',
                'left': 'left',
                'right': 'right',
			});
            

// Color array           
            let colorList = [
						{bg: "assets/1.png", paddle: "#4F8F9A", ball: "#4F8F9A", p1: "#3F767F", p2: "#4F8F9A", p3: "#4A737A"},
						{bg: "assets/2.png", paddle: "#A0D18E", ball: "#A0D18E", p1: "#84C98B", p2: "#A0D18E", p3: "#7EC78F"},
						{bg: "assets/3.png", paddle: "#548675", ball: "#548675", p1: "#61937F", p2: "#4C7C6C", p3: "#548675"},
						{bg: "assets/4.png", paddle: "#6CB8B8", ball: "#6CB8B8", p1: "#6CB8B8", p2: "#5CA4B7", p3: "#4694AF"}
						//{bg: "assets/#.png", paddle: "#", b.setColor: "#", setBallColor: "#"},
					];
            let cIndex = 0;
            let currColors = colorList[cIndex];
            
            //pong.players.a.on('37', function() {console.log('test');});
//                        pong.players.a.on('left', function() {pong.players.a.setColor('#FF134D');});

           
            
            //pong.players.a.on('hit', function () //if color == ball color)

            pong.players.b.setSpeed(160);
            
			pong.on('update', function () {
				if (pong.players.b.y < pong.balls[0].y) {
					pong.players.b.move(1);
				} else if (pong.players.b.y > pong.balls[0].y) {
					pong.players.b.move(-1);
				}
			});
            

//            Change color based on left and right key press
//            should work with RGB so you can easily add or subtract r g and b to change colors
            var pNumber = 1;
            
            var paddleColor = "p" + pNumber;
            
            
            window.onkeydown = function(e) {
                var key = e.keyCode ? e.keyCode : e.which;
                if(key == 37){
                    
                    if (pNumber < 3) {
                        pNumber++;
//                        console.log(pNumber);
                    } else {
                        pNumber = 1;
//                        console.log(pNumber);
                    };  
                    pong.players.a.setColor(currColors["p"+pNumber]);
                    
                    
                } else if (key == 39) {
//                    pnumber not changing for some reason? on the right track though...
//                    pNumber = 2;
                     if (pNumber < 3) {
                        pNumber++;
//                        console.log(pNumber);
                    } else {
                        pNumber = 1;
//                        console.log(pNumber);
                    };  
                    pong.players.a.setColor(currColors["p"+pNumber]);
//                    console.log(pNumber);
                   
//                    console.log("p"+pNumber);
                    
                };
            };            
            
            
//          Run function when left paddle is hit (use to check the color of ball to match color of paddle), use if else command.
//            pong.players.a.on('hit', function() {
//                console.log('check color ==');
//            });
            
            
            
            
            
//          Make ball bigger by 20 px each hit
            
//            pong.on('hit', function () {
//				pong.setBallSize(pong.balls[0].size + 20);
//                pong.players.b.setHeight(pong.players.b.height + 1);
//                
//			});
        
	
            
  // Change color on point          
     pong.on('point', function pickNewColor() {
		if (cIndex < colorList.length - 1) {
			cIndex++;
			currColors = colorList[cIndex];
		} else {
			cIndex = 0;
			currColors = colorList[cIndex];
		};
	});    
    
    function setColors () {
				pong.setBackgroundImage(currColors.bg);
                pong.players.a.setColor(currColors["p"+pNumber]);
                pong.players.b.setColor(currColors.paddle);
                pong.setBallColor(currColors.ball);
			}
            
            setColors();
            
    pong.on('point', function() {
        setColors();
//        pong.Ball.prototype.render(clear();)
        
//        pong.Ball.prototype.render.removeChild(this.graphics);
//        IKnowParentContainer.removeChild(thisSmallThingy);
        });
            
            pong.on('point', function (player) {
                //      On point, run function. In this case it checks if the score was a certain number, and shows win message.
                if (player.score === 5) {
                var pName = (player === pong.players.a) ? 'A' : 'B';
                pong.win('Player ' + pName + ' Wins!');
                pong.Ball.prototype.render.removeChild(this.graphics);
                } else {}
            })
            
		};
        
    
	</script>
</head>
<body>
    <div class="frame">
	<div id="pong"></div>

	<div class="panel">
		Move with [ UP ] [ DOWN ] | Change colors with [ RIGHT ] [ LEFT ] | Pause with [ P ]
	</div>
    </div>
    <div class="hidden">
	<script type="text/javascript">
		<!--//--><![CDATA[//><!--
			var images = new Array()
			function preload() {
				for (i = 0; i < preload.arguments.length; i++) {
					images[i] = new Image()
					images[i].src = preload.arguments[i]
				}
			}
			preload(
				"/assets/1.png",
				"/assets/2.png",
				"/assets/3.png",
                "/assets/4.png"
			)
		//--><!]]>
	</script>
</div>
</body>
</html>